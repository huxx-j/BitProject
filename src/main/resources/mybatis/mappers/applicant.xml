<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="applicant">
	<resultMap id="rm" type="CurriculumVo">
		<result column="CurriculumCate_no" property="curriculumCate_no" />
		<result column="Package_no" property="package_no" />
		<result column="Curriculum_no" property="curriculum_no" />
		<result column="WorkType" property="workType" />
		<result column="CurriName" property="curriName" />
		<result column="PeriodFr" property="periodFr" />
		<result column="PeriodTo" property="periodTo" />
		<result column="StartDay" property="startDay" />
		<result column="Time" property="time" />
		<result column="Num" property="num" />
		<result column="Money" property="money" />
		<result column="Support" property="support" />
		<result column="Inquiry" property="inquiry" />
		<result column="State" property="state" />
		<result column="MainViewFlag" property="mainViewFlag" />
		<result column="DatailViewFlag" property="datailViewFlag" />
	</resultMap>

	<select id="getCurriList" parameterType="String" resultType="com.bitacademy.vo.CurriculumVo">

<![CDATA[
		select CurriName,Curriculum_no from Curriculum
		join CurriculumCate on Curriculum.CurriculumCate_no = CurriculumCate.CurriculumCate_no
		where CateName = #{cateName};
	]]>

</select><!-- 맨윗줄 업무구분관련된 수업이름 가져가는 쿼리 -->

<select id="getWorkType" resultType="com.bitacademy.vo.CurriculumVo">

<![CDATA[
		select CateName from CurriculumCate group by CateName;
	]]>

</select><!-- 맨윗줄 업무구분 가져가는 쿼리 -->

	<select id="getApplyStudent" parameterType="int" resultType="com.bitacademy.vo.ApplyUserVo">

<![CDATA[

	   select Users.User_no, Gisu.GisuName,Users.NameHan, Users.BirthDate,Users.Gender,
	   		  ApplyInfo.TestResult,Users.Cellphone,ApplyInfo.ApplyDate, ApplyInfo.TestDate,
	   		  UserScholarship.School, UserScholarship.Major,
	   		  ApplyInfo.Deposit

	   from ApplyInfo

	   join Users on Users.User_no = ApplyInfo.User_no
	   join UserScholarship on Users.User_no = UserScholarship.User_no
	   join Curriculum on ApplyInfo.Curriculum_no = Curriculum.Curriculum_no
	   join Gisu on Curriculum.Curriculum_no = Gisu.Curriculum_no

	   where Curriculum.Curriculum_no = #{curriculum_no};

	]]>

</select><!-- 그리드영역 지원자 리스트  -->

	<select id="getAppliedList" parameterType="int" resultType="com.bitacademy.vo.ApplyUserVo">

<![CDATA[

	   select ApplyInfo.TestDate,Curriculum.CurriName,Curriculum.Curriculum_no,Users.User_no

	   from ApplyInfo

	   join Users on Users.User_no = ApplyInfo.User_no
	   join Curriculum on ApplyInfo.Curriculum_no = Curriculum.Curriculum_no

	   where Users.User_no = #{user_no};
	]]>

</select><!-- 선택된 사람의 과거 지원내역 가져가는 쿼리  -->

	<select id="apply_details" parameterType="map" resultType="com.bitacademy.vo.ApplyUserVo">

<![CDATA[

	   select Curriculum.CurriName,Curriculum.Curriculum_no,CurriculumCate.CateName,
	   		  ApplyInfo.ApplyType,ApplyInfo.TestLang,ApplyInfo.TestScore,ApplyInfo.TestResult,
	   		  ApplyInfo.DepositDate,ApplyInfo.DepositAmount,ApplyInfo.CardPayDate,ApplyInfo.CardPayAmount,
	   		  ApplyInfo.Deposit,ApplyInfo.TotalPay,ApplyInfo.User_no,ApplyInfo.Consult

	   from ApplyInfo

	   join Curriculum on ApplyInfo.Curriculum_no = Curriculum.Curriculum_no
	   join CurriculumCate on Curriculum.CurriculumCate_no = CurriculumCate.CurriculumCate_no

	   where Curriculum.Curriculum_no = #{curriculum_no} and ApplyInfo.User_no = #{user_no}
	]]>

</select><!-- 선택된 과거 지원내역의 상세내용 -->

	<update id="applyUpdate" parameterType="com.bitacademy.vo.ApplyUserVo">

		<![CDATA[

				update ApplyInfo
								set ApplyType=#{applyType},
									TestLang=#{testLang},
									TestScore=#{testScore},
									TestResult=#{testResult},
									Deposit=#{deposit},
									DepositAmount=#{depositAmount},
									CardPayDate=#{cardPayDate},
									CardPayAmount=#{cardPayAmount},
									DepositDate=#{depositDate},
									TotalPay=#{totalPay},
									Consult=#{consult}

				where User_no=#{user_no} and Curriculum_no=#{curriculum_no};
		]]>

</update><!-- 지원내역 수정 쿼리  -->

</mapper>