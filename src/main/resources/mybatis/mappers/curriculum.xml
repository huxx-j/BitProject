<?xml version="1.0" encoding="UTF-8" ?>


<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="curriculum">

    <!--성우-->
    <select id="getCateName" resultType="String">
        <![CDATA[
        SELECT CateName from CurriculumCate group by CateName
        ]]>
    </select>

    <select id="getCurriList" parameterType="String" resultType="CurriculumVo">
        <![CDATA[
         select Curriculum_no, CurriName from Curriculum C
  			join CurriculumCate C2 on C.CurriculumCate_no = C2.CurriculumCate_no and C2.CateName=#{workType}
        ]]>
    </select>

    <select id="getCurriInfo" parameterType="Int" resultType="CurriculumVo">
        <![CDATA[
        select CurriName, StartDate, EndDate from Curriculum where Curriculum_no=#{curriculum_no};
        ]]>
    </select>
    <!--성우-->



    <!--희준-->
    <!-- 커리큘럼 조회 -->
     <select id="viewCurriculum" parameterType="String" resultType="com.bitacademy.vo.CurriculumVo" >
 		<![CDATA[
  			SELECT 	cc.cateName, cc.curriculumCate_no,
  					c.curriculum_no, c.package_no, c.curriName, c.startDate, c.endDate, c.time, c.maxCnt, c.price,
  					c.support, c.managerInfo, c.state, c.curriNickname, c.curriculumCate_no, c.mainViewFlag, c.detailViewFlag,
  					p.packageName, p.package_no,
  					g.gisuName
			FROM Curriculum as c, Package as p, Gisu as g, CurriculumCate as cc
			WHERE c.package_no = p.package_no
			AND g.curriculum_no = c.curriculum_no
			AND cc.curriculumCate_no = c.curriculumCate_no
			AND c.curriculum_no = #{curriculum_no};
  		]]> 
  	</select>
 	
	<!-- 커리큘럼 수정 -->
    <update id = "editCurri" parameterType = "com.bitacademy.vo.CurriculumVo">
 		<![CDATA[
 			UPDATE Curriculum
 			SET
 			curriName = #{curriName}
 			, curriNickname = #{curriNickname}
 			, startDate = #{startDate}
 			, endDate = #{endDate}
 			, time = #{time}
 			, maxCnt = #{maxCnt}
 			, price = #{price}
 			, support = #{support}
 			, managerInfo = #{managerInfo}
 			, state = #{state}
 			, package_no = #{package_no}
 			WHERE curriculum_no = #{curriculum_no}
 		]]>
 	</update>
    <update id = "editCurriCate" parameterType = "com.bitacademy.vo.CurriculumCateVo">
 		<![CDATA[
 			UPDATE CurriculumCate
 			SET
 			cateName = #{cateName}
 			WHERE curriculum_no = #{curriculum_no}
 		]]>
 	</update>
 	<!--
    <update id = "editPackage" parameterType = "com.bitacademy.vo.CurriculumCateVo">
 		<![CDATA[
 			UPDATE Package
 			SET
 			WHERE curriculum_no = #{curriculum_no}
 		]]>
 	</update>
 -->
	<!-- 커리큘럼 추가 -->
	<!--
    <insert id="addCurri" parameterType = "com.bitacademy.vo.CurriculumVo">
 		<![CDATA[
 			INSERT INTO Curriculum (curriculumCate_no, workType, curriName, curriNickname, startDate, endDate, time, num, money, support, inquiry, state, package_no)
			VALUES(
				(SELECT curriculumCate_no FROM CurriculumCate WHERE curriculumCate_no = #{curriculumCate_no}),
				#{workType},
				#{curriName},
				#{curriNickname},
				#{startDate},
				#{endDate},
				#{time},
				#{maxCnt},
				#{price},
				#{support},
				#{managerInfo},
				#{state},
			    (SELECT package_no from Package WHERE package_no = #{package_no})
			    );
 		]]>
 	</insert>
 	 -->
	
    <select id = "currilist"  resultType = "com.bitacademy.vo.CurriculumVo">
		<![CDATA[
			SELECT 	cc.cateName,
					c.curriculum_no, c.package_no, c.curriculumCate_no, c.curriName, c.startDate, c.endDate, c.time, c.maxCnt, c.price, c.support, c.managerInfo, c.state, c.curriNickname, c.mainViewFlag, c.detailViewFlag
			FROM 	Curriculum as c, CurriculumCate as cc
			WHERE	c.curriculumCate_no = cc.curriculumCate_no
		]]>
	</select>

    <select id = "curriCateList" resultType = "com.bitacademy.vo.CurriculumCateVo">
		<![CDATA[
			SELECT curriculumCate_no, cateName, groupCode, parentCode, depth
			FROM CurriculumCate;
		]]>
	</select>
	
<!-- 	//전체지원자리스트 조회 -->
	<select id = "viewApplicantList" parameterType="String" resultType = "com.bitacademy.vo.ApplicantVo">
		<![CDATA[
			SELECT u.User_no, u.NameHan, u.BirthDate, CASE u.gender WHEN 1 THEN '남자' ELSE '여자' END gender, a.TestResult, a.applicant_no, c.curriculum_no
			FROM ApplyInfo as a, Users as u, Curriculum as c 
			WHERE a.User_no = u.User_no
			AND c.curriculum_no = a.curriculum_no
			AND a.curriculum_no = #{curriculum_no}
		]]>
	
	</select>


    <!--
    <select id = "studentManagement" parameterType = "String" resultType = "com.bitacademy.vo.ApplicantVo">
        <![CDATA[

            select  u.User_no, u.NameHan, u.BirthDate, a.TestResult
            from Users as u, ApplyInfo as a
            where u.User_no = a.User_no

        ]]>

    </select>
     -->
<!--희준-->

</mapper>
